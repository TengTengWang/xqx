









<center> <H1>TIDB测试报告</H1></center >





























<center> <H4>国际商业机器（中国）有限公司</H4></center >

<center> <H4>2018年7月</H4></center >

<div STYLE="page-break-after: always;"></div>

[TOC]

<div STYLE="page-break-after: always;"></div>



## 1. 压测环境

### 1.1 TIDB环境

| 节点类型    | 系统            | 公网IP         | CPU  | 内存 | 内网   |
| ----------- | --------------- | -------------- | ---- | ---- | ------ |
| TiDB / TiPD | CentOS 7.4 64位 | 47.98.55.185   | 56   | 160G | 10Gbps |
| TiDB / TiPD | CentOS 7.4 64位 | 47.98.112.76   | 56   | 160G | 10Gbps |
| TiDB / TiPD | CentOS 7.4 64位 | 47.98.33.165   | 56   | 160G | 10Gbps |
| TiKV        | CentOS 7.4 64位 | 47.97.201.205  | 64   | 512G | 10Gbps |
| TiKV        | CentOS 7.4 64位 | 116.62.246.55  | 64   | 512G | 10Gbps |
| TiKV        | CentOS 7.4 64位 | 47.98.37.27    | 64   | 512G | 10Gbps |
| TiKV        | CentOS 7.4 64位 | 47.98.109.102  | 64   | 512G | 10Gbps |
| TiKV        | CentOS 7.4 64位 | 47.98.63.33    | 64   | 512G | 10Gbps |
| TiKV        | CentOS 7.4 64位 | 116.62.214.179 | 64   | 512G | 10Gbps |

### 1.2 测试客户端环境

#### 1.2.1 3节点

从三个TIDB节点上直接发起测试。

| 节点编号 | 系统            | 公网IP       | CPU  | 内存 | 内网   |
| -------- | --------------- | ------------ | ---- | ---- | ------ |
| 1        | CentOS 7.4 64位 | 47.98.55.185 | 56   | 160G | 10Gbps |
| 2        | CentOS 7.4 64位 | 47.98.112.76 | 56   | 160G | 10Gbps |
| 3        | CentOS 7.4 64位 | 47.98.33.165 | 56   | 160G | 10Gbps |



#### 1.2.2 10节点

使用10个单独的节点发起测试。

| 节点编号 | 系统            | 公网IP         | CPU  | 内存 | 内网  |
| -------- | --------------- | -------------- | ---- | ---- | ----- |
| 1        | CentOS 7.4 64位 | 120.55.46.26   | 8    | 32G  | 2Gbps |
| 2        | CentOS 7.4 64位 | 47.96.169.158  | 8    | 32G  | 2Gbps |
| 3        | CentOS 7.4 64位 | 47.98.38.1     | 8    | 32G  | 2Gbps |
| 4        | CentOS 7.4 64位 | 47.97.162.82   | 8    | 32G  | 2Gbps |
| 5        | CentOS 7.4 64位 | 47.97.201.163  | 8    | 32G  | 2Gbps |
| 6        | CentOS 7.4 64位 | 47.97.103.55   | 8    | 32G  | 2Gbps |
| 7        | CentOS 7.4 64位 | 121.43.187.23  | 8    | 32G  | 2Gbps |
| 8        | CentOS 7.4 64位 | 116.62.193.194 | 8    | 32G  | 2Gbps |
| 9        | CentOS 7.4 64位 | 47.98.33.215   | 8    | 32G  | 2Gbps |
| 10       | CentOS 7.4 64位 | 47.97.196.70   | 8    | 32G  | 2Gbps |



## 2. 压测说明

&emsp;&emsp;Sysbench 测试脚本： <https://github.com/pingcap/tidb-bench/tree/master/sysbench>版本v2.0.0-rc6。

&emsp;&emsp;单条记录0.2kb;

## 3. 压测结果

### 3.1 Insert

| TableCount | TableSize | SysbenchThreads | TPS    | Latency(avg/.95)    | CPU(TiDB/TiKV) |
| ---------- | --------- | --------------- | ------ | ------------------- | -------------- |
| 16         | 1000万    | 256 * 3         | 34,235 | 22.43ms / 36.24ms   | 15U /  9U      |
| 16         | 1000万    | 256 * 10        | 46,333 | 55.25ms / 97.55ms   | 18U / 10U      |
| 32         | 1000万    | 1024 * 3        | 55,172 | 55.67ms / 126.28ms  | 27U / 11U      |
| 32         | 1000万    | 1024 * 10       | 53,159 | 192.59ms / 311.65ms | 22U / 10U      |

### 3.2 Select

| TableCount | TableSize | SysbenchThreads | QPS     | Latency(avg/.95)  | CPU(TiDB/TiKV) |
| ---------- | --------- | --------------- | ------- | ----------------- | -------------- |
| 16         | 1000万    | 256 * 3         | 170,100 | 4.72ms / 23.57ms  | 20U / 4U       |
| 16         | 1000万    | 256 * 10        | 183,667 | 14.01ms / 50.11ms | 36U / 5U       |
| 32         | 1000万    | 1024 * 3        | 300,697 | 10.21ms / 37.34ms | 43U / 7U       |
| 32         | 1000万    | 1024 * 10       | 351,362 | 29.14ms / 58.92ms | 48U / 10U      |
| 32         | 10000万   | 1024 * 10       | 364,647 | 28.08ms / 78.04ms | 48U / 7U       |

### 3.3 OLPT

| TableCount | TableSize | SysbenchThreads | TPS   | QPS     | Latency(avg/.95)      | CPU(TiDB/TiKV) |
| ---------- | --------- | --------------- | ----- | ------- | --------------------- | -------------- |
| 16         | 1000万    | 256 * 3         | 3,727 | 74,557  | 206.00ms / 270.65ms   | 24U / 4U       |
| 16         | 1000万    | 256 * 10        | 4,172 | 83,443  | 613.62ms / 802.05ms   | 26U / 6U       |
| 32         | 1000万    | 1024 * 3        | 7,712 | 154,254 | 398.22ms / 536.5ms    | 36U / 13U      |
| 32         | 1000万    | 1024 * 10       | 7,575 | 151,507 | 1351.25ms / 1705.63ms | 37U / 13U      |
| 32         | 10000万   | 1024 * 10       | 8,977 | 179,546 | 1139.68ms / 1280.92ms | 33U / 8U       |



## 4. 附件

&emsp;&emsp;各组测试详细结果请查看《TIDB测试附件》